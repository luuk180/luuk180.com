steps:
 - id: install_packages_and_build
   name: 'node:current'
   entrypoint: 'npm'
   args:
   - 'install && npm run build'
 - id: remove_old_files
   name: 'gcr.io/cloud-builders/gsutil'
   args: ['rm', '-rf', '\$_ANGULAR_APP_BUCKET_PATH']
   waitFor:
   - install_packages_and_build
 - id: copy_prerendered_files
   name: 'gcr.io/cloud-builders/gsutil'
   args: ['cp','-r','dist/Portfolio/*', '\${_ANGULAR_APP_BUCKET_PATH}']
   waitFor:
   - remove_old_files
 - id: set_website_configuration
   name: 'gcr.io/cloud-builders/gsutil'
   args: ['web', 'set', '-m', 'index.html','\${_ANGULAR_APP_BUCKET_PATH}']
   waitFor:
   - copy_prerendered_files
 - id: set_permissions_for_website_files
   name: 'gcr.io/cloud-builders/gsutil'
   args: ['acl','ch','-u','AllUsers:R','-r', '\${_ANGULAR_APP_BUCKET_PATH}']
   waitFor:
   - copy_prerendered_files
